C51 COMPILER V9.02   F39X_MASTER_DEVSPECIFIC                                               03/19/2013 14:50:00 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE F39X_MASTER_DEVSPECIFIC
OBJECT MODULE PLACED IN F39x_Master_DevSpecific.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.exe F39x_Master_DevSpecific.c DB OE BR INCDIR(C:\SiLabs\MCU\Inc)

line level    source

   1          //-----------------------------------------------------------------------------
   2          // Fnnn_TargetBL_DevSpecific.c
   3          //-----------------------------------------------------------------------------
   4          // Copyright (C) 2010 Silicon Laboratories, Inc.
   5          // http://www.silabs.com
   6          //
   7          // Program Description:
   8          //
   9          // [*** TEMPLATE INFORMATION ***]
  10          // Filename: Fnnn_TargetBL_DevSpecific.c
  11          // nnn => Fill-in with the MCU family part number.
  12          // Examples: F50x_TargetBL_DevSpecific.c, F34x_TargetBL_DevSpecific.c
  13          //
  14          //
  15          // Target:         C8051Fxxx (Any Silicon Labs Flash MCU)
  16          // Tool chain:     Generic
  17          // Command Line:   None
  18          //
  19          //
  20          // Release 1.0 / 01SEP2010 (PKC)
  21          //    -Initial Revision
  22          //
  23          //-----------------------------------------------------------------------------
  24          
  25          //-----------------------------------------------------------------------------
  26          // Includes
  27          //-----------------------------------------------------------------------------
  28          #include <compiler_defs.h>
  29          #include "Fxxx_SFR_Defs_Wrapper.h"     // This header file will include the
  30                                                 // real MCU register definition file
  31          
  32          #include "Fxxx_Master_Config.h"
  33          #include "Fxxx_Master_Interface.h"
  34          #include "Fxxx_Target_Interface.h"
  35          #include "Fxxx_DataSource_Interface.h"
  36          #include "Fxxx_Master_Validation.h"
  37          
  38          //-----------------------------------------------------------------------------
  39          // Global CONSTANTS
  40          //-----------------------------------------------------------------------------
  41          
  42          // ------------------------------------------
  43          // *** Device-Specific *** 
  44          // Change this as necessary based on MCU
  45          // ------------------------------------------
  46          SBIT (P1_0_SWITCH, SFR_P1, 0);
  47          SBIT (P1_1_LED, SFR_P1, 1);
  48          
  49          #define LIN_TX_PUSH_PULL 0 // 0=Open-drain; 1=Push-pull output
  50          
  51          //-----------------------------------------------------------------------------
  52          // Global Variables
  53          //-----------------------------------------------------------------------------
  54          
  55          
C51 COMPILER V9.02   F39X_MASTER_DEVSPECIFIC                                               03/19/2013 14:50:00 PAGE 2   

  56          //-----------------------------------------------------------------------------
  57          // Function Prototypes (Local)
  58          //-----------------------------------------------------------------------------
  59          void OSCILLATOR_Init (void);
  60          void PORT_Init (void);
  61          
  62          
  63          //=============================================================================
  64          // Function Definitions
  65          //=============================================================================
  66          
  67          //-----------------------------------------------------------------------------
  68          // Disable_Watchdog
  69          //-----------------------------------------------------------------------------
  70          //
  71          // Return Value:  None
  72          // Parameters:    None
  73          //
  74          //
  75          //
  76          //-----------------------------------------------------------------------------
  77          void Disable_Watchdog (void)
  78          {
  79   1         // *** Device-Specific *** Change this as necessary based on MCU.
  80   1         PCA0MD &= ~0x40;
  81   1      }
  82          
  83          //-----------------------------------------------------------------------------
  84          // Init_Device
  85          //-----------------------------------------------------------------------------
  86          //
  87          // Return Value:  None
  88          // Parameters:    None
  89          //
  90          //
  91          //
  92          //-----------------------------------------------------------------------------
  93          void Init_Device (void)
  94          {
  95   1         OSCILLATOR_Init ();
  96   1         PORT_Init ();
  97   1      
  98   1         SRC_Comm_Init ();
  99   1      
 100   1      //   Comm_Init ();
 101   1      
 102   1         // *** Add calls to any other init functions here as necessary ***
 103   1      }
 104          
 105          //-----------------------------------------------------------------------------
 106          // OSCILLATOR_Init
 107          //-----------------------------------------------------------------------------
 108          //
 109          // Return Value : None
 110          // Parameters   : None
 111          //
 112          // This routine initializes the system clock to use the internal oscillator
 113          // at its maximum frequency (24 MHz); Also enables the VDD monitor set to its
 114          // high threshold and selected as a reset source.
 115          //
 116          //-----------------------------------------------------------------------------
 117          void OSCILLATOR_Init (void)
C51 COMPILER V9.02   F39X_MASTER_DEVSPECIFIC                                               03/19/2013 14:50:00 PAGE 3   

 118          {
 119   1         OSCICN = 0x83;                      // Set system clock to 24.5 MHz
 120   1         VDM0CN = 0x80;                      // Enable VDD monitor and early warning
 121   1         RSTSRC = 0x02;                      // Enable VDD monitor as a reset source
 122   1      }
 123          
 124          //-----------------------------------------------------------------------------
 125          // PORT_Init
 126          //-----------------------------------------------------------------------------
 127          //
 128          // Return Value : None
 129          // Parameters   : None
 130          //
 131          // Configure the Crossbar and GPIO ports.
 132          //
 133          // P0.4   digital   push-pull    UART0 TX
 134          // P0.5   digital   open-drain   UART0 RX
 135          //
 136          // P0.0   digital  open-drain    SDA0
 137          // P0.1   digital  open-drain    SCL0
 138          //
 139          // P1.1   digital  push-pull     LED
 140          // P1.0   digital  open-drain    SW
 141          
 142          //-----------------------------------------------------------------------------
 143          void PORT_Init (void)
 144          {
 145   1          P0MDOUT   = 0x10;                                   // Enable UART0 TX as push-pull output
 146   1          P1MDOUT   = 0x02;                                   // P1.1 (LED) is push-pull
 147   1          XBR0      = 0x05;                                   // Enable UART0 and SMBUS0
 148   1          XBR1      = 0x40;                                   // Enable crossbar
 149   1      }
 150          
 151          //-----------------------------------------------------------------------------
 152          // Check_Pin_State
 153          //-----------------------------------------------------------------------------
 154          //
 155          // Return Value : None
 156          // Parameters   : None
 157          //
 158          //
 159          //-----------------------------------------------------------------------------
 160          U8 Check_Pin_State (void)
 161          {
 162   1         if (P1_0_SWITCH == 0)
 163   1         {
 164   2            return (PIN_ASSERTED); // Pin goes low when switch is pressed
 165   2         }
 166   1         else
 167   1         {
 168   2            return (PIN_NOT_ASSERTED);
 169   2         }
 170   1      }
 171          
 172          //-----------------------------------------------------------------------------
 173          // Set_LED_State
 174          //-----------------------------------------------------------------------------
 175          //
 176          // Return Value:  None
 177          // Parameters:    None
 178          //
 179          //
C51 COMPILER V9.02   F39X_MASTER_DEVSPECIFIC                                               03/19/2013 14:50:00 PAGE 4   

 180          //
 181          //-----------------------------------------------------------------------------
 182          void Set_LED_State (U8 state)
 183          {
 184   1         switch (state)
 185   1         {
 186   2            case LED_OFF:
 187   2               P1_1_LED = 0;
 188   2               break;
 189   2            case LED_ON:
 190   2               P1_1_LED = 1;
 191   2               break;
 192   2            case LED_TOGGLE:
 193   2               P1_1_LED = !P1_1_LED;
 194   2               break;
 195   2            default:
 196   2               break;
 197   2         }
 198   1      }
 199          
 200          //-----------------------------------------------------------------------------
 201          // End Of File
 202          //-----------------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     65    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
