C51 COMPILER V9.02   F39X_FLASH                                                            03/15/2013 16:18:47 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE F39X_FLASH
OBJECT MODULE PLACED IN F39x_Flash.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.exe F39x_Flash.c DB OE BR INCDIR(C:\SiLabs\MCU\Inc) ROM(SMALL) OT(11,SIZE)

line level    source

   1          //-----------------------------------------------------------------------------
   2          // Fnnn_Flash.c
   3          //-----------------------------------------------------------------------------
   4          // Copyright (C) 2010 Silicon Laboratories, Inc.
   5          // http://www.silabs.com
   6          //
   7          // Program Description:
   8          //
   9          // [*** TEMPLATE INFORMATION ***]
  10          // Filename: Fnnn_Flash.c
  11          // nnn => Fill-in with the MCU family part number.
  12          // Examples: F50x_Flash.c, F34x_Flash.c
  13          // 
  14          // Note: Typically, the flash primitive functions from application note AN201
  15          // can be used here with minimal modifications. FLASH_ByteRead is needed only
  16          // for code-banked devices.
  17          //
  18          // Note: Typically, the flash primitive functions from application note AN201
  19          // can be used here with minimal modifications. FLASH_ByteRead is needed only
  20          // for code-banked devices.
  21          //
  22          // Note: Scratchpad memory access is NOT supported.
  23          //
  24          // Target:         C8051Fxxx (Any Silicon Labs Flash MCU)
  25          // Tool chain:     Generic
  26          // Command Line:   None
  27          //
  28          //
  29          // Release 1.0 / 01SEP2010 (PKC)
  30          //    -Initial Revision
  31          //
  32          //-----------------------------------------------------------------------------
  33          
  34          //-----------------------------------------------------------------------------
  35          // Includes
  36          //-----------------------------------------------------------------------------
  37          #include <compiler_defs.h>
  38          #include "Fxxx_SFR_Defs_Wrapper.h"     // This header file will include the
  39                                                 // real MCU register definition file
  40          
  41          #include "Fxxx_Target_Config.h"
  42          #include "Fxxx_Target_Interface.h"
  43          
  44          #include "Fxxx_TargetBL_Config.h"
  45          #include "Fxxx_TargetBL_Interface.h"
  46          //-----------------------------------------------------------------------------
  47          // Global CONSTANTS
  48          //-----------------------------------------------------------------------------
  49          
  50          
  51          
  52          //-----------------------------------------------------------------------------
  53          // Global Variables
  54          //-----------------------------------------------------------------------------
  55          
C51 COMPILER V9.02   F39X_FLASH                                                            03/15/2013 16:18:47 PAGE 2   

  56          
  57          //-----------------------------------------------------------------------------
  58          // Function Prototypes (Local)
  59          //-----------------------------------------------------------------------------
  60          
  61          
  62          //=============================================================================
  63          // Function Definitions
  64          //=============================================================================
  65          
  66          //-----------------------------------------------------------------------------
  67          // FLASH_Modify
  68          //-----------------------------------------------------------------------------
  69          //
  70          // Return Value : None
  71          // Parameters   :
  72          //   1) U16 addr - address of the byte to write to
  73          //   2) U8 byte - byte to write to Flash.
  74          //
  75          // This routine writes <byte> to the linear FLASH address <addr> if PSCTL == 1.
  76          // This routine erases the FLASH page containing the linear FLASH address is
  77          // PSCTL == 3.
  78          //-----------------------------------------------------------------------------
  79          void FLASH_Modify (U16 addr, U8 byte)
  80          {
  81   1      
  82   1         // *** Device-Specific *** 
  83   1         // TODO: Add this based on MCU.
  84   1      
  85   1         // ** IMPORTANT ** When modifying flash primitive functions to fit in this 
  86   1         // template, it is important to remove the literal flash key values and use 
  87   1         // the global variables Flash_Key0 and Flash_Key1 instead.  
  88   1      
  89   1      //   U8 xdata * data pwrite;             // FLASH write pointer
  90   1      
  91   1      //   pwrite = (U8 xdata *) addr;
  92   1      
  93   1         VDM0CN = 0xA0;                      // Enable VDD monitor and high threshold
  94   1      
  95   1         Set_RSTSRC_002h ();                 // Enable VDD monitor as a reset source
*** WARNING C206 IN LINE 95 OF F39X_FLASH.C: 'Set_RSTSRC_002h': missing function-prototype
  96   1      
  97   1         FLKEY  = Flash_Key0;                // Key Sequence 1
  98   1      
  99   1         FLKEY  = Flash_Key1;                // Key Sequence 2
 100   1      
 101   1         *((U8 xdata *) addr) = byte;
 102   1      //   *pwrite = byte;                     // Write the byte
 103   1      
 104   1         PSCTL &= ~0x03;                     // PSWE = 0 which disable writes
 105   1      }
 106          
 107          //-----------------------------------------------------------------------------
 108          // End Of File
 109          //-----------------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     30    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.02   F39X_FLASH                                                            03/15/2013 16:18:47 PAGE 3   

   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
